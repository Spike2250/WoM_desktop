# Копирование элементов архивной истории в новый случай
def arch_import(d, d_arch, copy_style, add_base=True):
    # добавляем данные о базовой истории
    if add_base:
        add_base_info(d, d_arch)
    # перебираем словари и записываем в новый данные из архива
    if copy_style == 'full':
        full_copy(d, d_arch)
    elif copy_style == 'only_adm':
        only_admition_data_copy(d, d_arch)
    elif copy_style == 'dynamic':
        dynamic_copy(d, d_arch)
    # возващаем словарь нового случая
    return d


def add_base_info(d, d_arch):
    d['based_history_uic'] = d_arch['unic_number']
    based_history_info = f"{d_arch['ФИО_пациента']}, "\
                         f"{d_arch['МКБ']}, "\
                         f"{d_arch['дата_поступления']}-"\
                         f"{d_arch['дата_выписки']}"
    d['based_history_info'] = based_history_info


def full_copy(d, d_arch):
    for list_ in keys:
        for key in keys[list_]:
            copy_d(d, d_arch, key, key)


def only_admition_data_copy(d, d_arch):
    copy_common_info(d, d_arch)
    for key in keys['adm']:
        copy_d(d, d_arch, key, key)


def dynamic_copy(d, d_arch):
    """копирует данные вставляя
    архивные статус/диагноз при выписке
    как статус/диагноз при поступлении
    для плавного ведения пациента от случая к случаю"""
    copy_common_info(d, d_arch)
    for index in range(len(keys['dis'])):
        copy_d(d, d_arch,
               key_1=keys['adm'][index],
               key_2=keys['dis'][index])


def copy_common_info(d, d_arch):
    for key in keys['common']:
        copy_d(d, d_arch, key, key)


def copy_d(d, d_arch, key_1, key_2):
    try:
        d[key_1] = d_arch[key_2]
    except KeyError:
        pass


# Список ключей для перезаписи из архива
keys = {
    'common': [
        'анамнез',
        'социальный_статус',
        'ЛН_инфо_нужда',
        'место_работы_1',
        'должность_1',
        'ЛН_номер_1',
        'первичный_лн',
        'С какого числа ЛН на руках',  # old
        'По какое число продлен ЛН',  # old
        'С_какого_числа_ЛН_на_руках',
        'По_какое_число_продлен_ЛН',
        'аллергия_чек',
        'аллергия',
        'эпид_анамнез_чек',
        'эпид_анамнез',
        'ГБ_чек',
        'СД_чек',
        'НРС_чек',
        'ИБС_чек',
        'ПОНМК_чек',
        'Ожирение_чек',
        'Гипотиреоз_чек',
        'Гипертиреоз_чек',
        'Гастрит_чек',
        'ВИЧ_чек',
        'ВГС_чек',
        'ВГБ_чек',
        'Астма_чек',
        'ХАН_чек',
        'БЦА_чек',
        'Другие_сопут_чек',
        'Другие_сопут',
        'принимает_медикаменты_чек',
        'принимает_медикаменты',
        'жалобы',
        'рост',
        'вес',
        'ЧДД',
        'АД_сист',
        'АД_диаст',
        'ЧСС',
        'Температура',
        'Сатурация',
        'Общее_состояние',
        'кожа',
        'высыпания',
        'лимфоузлы',
        'слизистые',
        'дыхание_1',
        'дыхание_2',
        'дыхание_3',
        'хрипы_чек',
        'хрипы_1',
        'хрипы_2',
        'хрипы_3',
        'одышка_чек',
        'одышка_1',
        'одышка_2',
        'одышка_3',
        'тоны_сердца_1',
        'тоны_сердца_2',
        'тоны_сердца_3',
        'шумы_сердца_чек',
        'шумы_сердца',
        'живот_1',
        'живот_2',
        'живот_3',
        'стул_1',
        'стул_2',
        'стул_3',
        'Мочеиспускание_1',
        'Мочеиспускание_2',
        'Мочеиспускание_доп',
        'Общ_статус_дополнение',
        'анамнез_дополненный',
        'экспертный_анамнез',
        'аллергологический_анамнез',
        'Эпидемиологический_анамнез',
        'медикаменты_прием',
        'перечень_хронических_заболеваний',
        'стол',
        'хрипы',
        'одышка',
        'тоны_сердца',
        'Мочеиспускание',
        'ИМТ',
        'Соматический_статус',
        'Соматический_статус_для_дневников',
        'Соматический_статус_выписка',
        'NIHSS',
        'ШРМ',
        'mRs',
        'IMR',
        'хаузер',
        'VAS',
        'наличие_боли',
        'ШРМ_вып',
        'mRs_вып',
        'IMR_вып',
        'хаузер_вып',
        'VAS_вып',
        'ВАШ_список',
        'Шкалы',
        'Шкалы_вып',
        'реаб_потенциал',
        'огран_1',
        'огран_2',
        'огран_3',
        'огран_4',
        'огран_5',
        'огран_6',
        'огран_7',
        'огран_8',
        'огран_9',
        'огран_10',
        'огран_11',
        'огран_12',
        'огран_13',
        'огран_14',
        'огран_15',
        'огран_другое',
        'факторы_ограничивающие_реабилитацию',
        'цель_1',
        'цель_2',
        'цель_3',
        'цель_4',
        'цель_5',
        'цель_6',
        'цель_7',
        'цель_8',
        'цель_9',
        'цель_10',
        'цель_11',
        'цель_12',
        'цель_13',
        'цель_14',
        'цель_15',
        'цель_16',
        'цель_17',
        'цель_18',
        'цель_19',
        'цель_другое',
        'цели_реабилитации',
    ],
    'adm': [
        'Сознание',
        'ШКГ',
        'RASS',
        'Контакт',
        'Ориентирование',
        'Менингеальные_1',
        'Менингеальные_2',
        'Менингеальные_3',
        'Речь_1',
        'Речь_2',
        'Речь_3',
        'ФТО',
        'обоняние',
        'острота_зрения',
        'поля_зрения',
        'зрачки',
        'аккомодация',
        'фотореакция',
        'конвергенция',
        'движения_гл_яблок',
        'парез_глазодвиг',
        'птоз',
        'нистагм',
        'V_пара',
        'V_пара_Ветви',
        'V_пара_Зельдер',
        'VII_пара',
        'VII_пара_дополнение',
        'слух',
        'центр_головокружение',
        'фонация',
        'мягкое_небо',
        'глотание',
        'питание',
        'дизартрия',
        'дизартрия_степень',
        'XI_пара',
        'XII_пара',
        'движ_конечности',
        'движ_суставы',
        'движ_позвоночник',
        'MRC_R_A_P',
        'MRC_R_A_D',
        'MRC_R_L_P',
        'MRC_R_L_D',
        'MRC_L_A_P',
        'MRC_L_A_D',
        'MRC_L_L_P',
        'MRC_L_L_D',
        'мышечный_тонус_1',
        'мышечный_тонус_2',
        'Ash_R_A_P',
        'Ash_R_A_D',
        'Ash_R_L_P',
        'Ash_R_L_D',
        'Ash_L_A_P',
        'Ash_L_A_D',
        'Ash_L_L_P',
        'Ash_L_L_D',
        'рефлексы_руки_1',
        'рефлексы_руки_2',
        'рефлексы_ноги_1',
        'рефлексы_ноги_2',
        'патологические_рефлексы',
        'трофика_мышц',
        'чувствительность_1',
        'чувствительность_2',
        'чувствительность_текст',
        'координация_1',
        'координация_2',
        'координация_текст',
        'экстрапирамидные_1',
        'экстрапирамидные_2',
        'экстрапирамидные_3',
        'эпилептический_статус',
        'функциональный_статус',
        'ходьба',
        'походка',
        'мелкая_моторика',
        'одевание',
        'подъем_по_лестнице',
        'прием_пищи',
        'письмо',
        'чтение',
        'функциональный_статус_дополнение',
        'NS_дополнение',
        'Менингеальные_знаки',
        'Речь',
        'Дизартрия_текст',
        'Мышечный_тонус',
        'VII_доп',
        'Чувствительность',
        'Координация_движений',
        'Экстрапирамидные',
        'NS_доп',
        'функ_статус_доп',
        'Сила_в_конечностях',
        'Неврологический_статус',
        'Неврологический_статус_сокращенный',
        'Основной_диагноз',
        'Сопутствующий_диагноз',
        's_domen_1',
        's_domen_1_q1',
        's_domen_1_q2',
        's_domen_1_q3',
        's_domen_2',
        's_domen_2_q1',
        's_domen_2_q2',
        's_domen_2_q3',
        's_domen_3',
        's_domen_3_q1',
        's_domen_3_q2',
        's_domen_3_q3',
        'b_domen_1',
        'b_domen_q1',
        'b_domen_2',
        'b_domen_q2',
        'b_domen_3',
        'b_domen_q3',
        'b_domen_4',
        'b_domen_q4',
        'b_domen_5',
        'b_domen_q5',
        'b_domen_6',
        'b_domen_q6',
        'b_domen_7',
        'b_domen_q7',
        'b_domen_8',
        'b_domen_q8',
        'b_domen_9',
        'b_domen_q9',
        'b_domen_10',
        'b_domen_q10',
        'b_domen_11',
        'b_domen_q11',
        'b_domen_12',
        'b_domen_q12',
        'b_domen_13',
        'b_domen_q13',
        'b_domen_14',
        'b_domen_q14',
        'b_domen_15',
        'b_domen_q15',
        'd_domen_1',
        'd_domen_r1',
        'd_domen_c1',
        'd_domen_2',
        'd_domen_r2',
        'd_domen_c2',
        'd_domen_3',
        'd_domen_r3',
        'd_domen_c3',
        'd_domen_4',
        'd_domen_r4',
        'd_domen_c4',
        'd_domen_5',
        'd_domen_r5',
        'd_domen_c5',
        'd_domen_6',
        'd_domen_r6',
        'd_domen_c6',
        'd_domen_7',
        'd_domen_r7',
        'd_domen_c7',
        'd_domen_8',
        'd_domen_r8',
        'd_domen_c8',
        'd_domen_9',
        'd_domen_r9',
        'd_domen_c9',
        'd_domen_10',
        'd_domen_r10',
        'd_domen_c10',
        'd_domen_11',
        'd_domen_r11',
        'd_domen_c11',
        'd_domen_12',
        'd_domen_r12',
        'd_domen_c12',
        'd_domen_13',
        'd_domen_r13',
        'd_domen_c13',
        'd_domen_14',
        'd_domen_r14',
        'd_domen_c14',
        'd_domen_15',
        'd_domen_r15',
        'd_domen_c15',
        'd_domen_16',
        'd_domen_r16',
        'd_domen_c16',
        'd_domen_17',
        'd_domen_r17',
        'd_domen_c17',
        'd_domen_18',
        'd_domen_r18',
        'd_domen_c18',
        'd_domen_19',
        'd_domen_r19',
        'd_domen_c19',
        'd_domen_20',
        'd_domen_r20',
        'd_domen_c20',
        'd_domen_21',
        'd_domen_r21',
        'd_domen_c21',
        'd_domen_22',
        'd_domen_r22',
        'd_domen_c22',
        'd_domen_23',
        'd_domen_r23',
        'd_domen_c23',
        'd_domen_24',
        'd_domen_r24',
        'd_domen_c24',
        'd_domen_25',
        'd_domen_r25',
        'd_domen_c25',
        'e_domen_1',
        'e_domen_1_+/.',
        'e_domen_q1',
        'e_domen_2',
        'e_domen_2_+/.',
        'e_domen_q2',
        'e_domen_3',
        'e_domen_3_+/.',
        'e_domen_q3',
        'e_domen_4',
        'e_domen_4_+/.',
        'e_domen_q4',
        'e_domen_5',
        'e_domen_5_+/.',
        'e_domen_q5',
        'e_domen_6',
        'e_domen_6_+/.',
        'e_domen_q6',
        'e_domen_7',
        'e_domen_7_+/.',
        'e_domen_q7',
        'e_domen_8',
        'e_domen_8_+/.',
        'e_domen_q8',
        'e_domen_9',
        'e_domen_9_+/.',
        'e_domen_q9',
        'e_domen_10',
        'e_domen_10_+/.',
        'e_domen_q10',
        'домены_структуры',
        'домены_функций',
        'домены_активности_и_участия',
        'домены_окружающей_среды',
        'МКФ_сумм',
    ],
    'dis': [
        'Сознание_вып',
        'ШКГ_вып',
        'RASS_вып',
        'Контакт_вып',
        'Ориентирование_вып',
        'Менингеальные_1_вып',
        'Менингеальные_2_вып',
        'Менингеальные_3_вып',
        'Речь_1_вып',
        'Речь_2_вып',
        'Речь_3_вып',
        'ФТО_вып',
        'обоняние_вып',
        'острота_зрения_вып',
        'поля_зрения_вып',
        'зрачки_вып',
        'аккомодация_вып',
        'фотореакция_вып',
        'конвергенция_вып',
        'движения_гл_яблок_вып',
        'парез_глазодвиг_вып',
        'птоз_вып',
        'нистагм_вып',
        'V_пара_вып',
        'V_пара_Ветви_вып',
        'V_пара_Зельдер_вып',
        'VII_пара_вып',
        'VII_пара_дополнение_вып',
        'слух_вып',
        'центр_головокружение_вып',
        'фонация_вып',
        'мягкое_небо_вып',
        'глотание_вып',
        'питание_вып',
        'дизартрия_вып',
        'дизартрия_степень_вып',
        'XI_пара_вып',
        'XII_пара_вып',
        'движ_конечности_вып',
        'движ_суставы_вып',
        'движ_позвоночник_вып',
        'MRC_R_A_P_вып',
        'MRC_R_A_D_вып',
        'MRC_R_L_P_вып',
        'MRC_R_L_D_вып',
        'MRC_L_A_P_вып',
        'MRC_L_A_D_вып',
        'MRC_L_L_P_вып',
        'MRC_L_L_D_вып',
        'мышечный_тонус_1_вып',
        'мышечный_тонус_2_вып',
        'Ash_R_A_P_вып',
        'Ash_R_A_D_вып',
        'Ash_R_L_P_вып',
        'Ash_R_L_D_вып',
        'Ash_L_A_P_вып',
        'Ash_L_A_D_вып',
        'Ash_L_L_P_вып',
        'Ash_L_L_D_вып',
        'рефлексы_руки_1_вып',
        'рефлексы_руки_2_вып',
        'рефлексы_ноги_1_вып',
        'рефлексы_ноги_2_вып',
        'патологические_рефлексы_вып',
        'трофика_мышц_вып',
        'чувствительность_1_вып',
        'чувствительность_2_вып',
        'чувствительность_текст_вып',
        'координация_1_вып',
        'координация_2_вып',
        'координация_текст_вып',
        'экстрапирамидные_1_вып',
        'экстрапирамидные_2_вып',
        'экстрапирамидные_3_вып',
        'эпилептический_статус_вып',
        'функциональный_статус_вып',
        'ходьба_вып',
        'походка_вып',
        'мелкая_моторика_вып',
        'одевание_вып',
        'подъем_по_лестнице_вып',
        'прием_пищи_вып',
        'письмо_вып',
        'чтение_вып',
        'функциональный_статус_дополнение_вып',
        'NS_дополнение_вып',
        'Менингеальные_знаки_вып',
        'Речь_вып',
        'Дизартрия_текст_вып',
        'Мышечный_тонус_вып',
        'VII_доп_вып',
        'Чувствительность_вып',
        'Координация_движений_вып',
        'Экстрапирамидные_вып',
        'NS_доп_вып',
        'функ_статус_доп_вып',
        'Сила_в_конечностях_вып',
        'Неврологический_статус_вып',
        'Неврологический_статус_сокращенный_вып',
        'Основной_диагноз_вып',
        'Сопутствующий_диагноз_вып',
        's_domen_dis_1',
        's_domen_dis_1_q1',
        's_domen_dis_1_q2',
        's_domen_dis_1_q3',
        's_domen_dis_2',
        's_domen_dis_2_q1',
        's_domen_dis_2_q2',
        's_domen_dis_2_q3',
        's_domen_dis_3',
        's_domen_dis_3_q1',
        's_domen_dis_3_q2',
        's_domen_dis_3_q3',
        'b_domen_dis_1',
        'b_domen_dis_q1',
        'b_domen_dis_2',
        'b_domen_dis_q2',
        'b_domen_dis_3',
        'b_domen_dis_q3',
        'b_domen_dis_4',
        'b_domen_dis_q4',
        'b_domen_dis_5',
        'b_domen_dis_q5',
        'b_domen_dis_6',
        'b_domen_dis_q6',
        'b_domen_dis_7',
        'b_domen_dis_q7',
        'b_domen_dis_8',
        'b_domen_dis_q8',
        'b_domen_dis_9',
        'b_domen_dis_q9',
        'b_domen_dis_10',
        'b_domen_dis_q10',
        'b_domen_dis_11',
        'b_domen_dis_q11',
        'b_domen_dis_12',
        'b_domen_dis_q12',
        'b_domen_dis_13',
        'b_domen_dis_q13',
        'b_domen_dis_14',
        'b_domen_dis_q14',
        'b_domen_dis_15',
        'b_domen_dis_q15',
        'd_domen_dis_1',
        'd_domen_dis_r1',
        'd_domen_dis_c1',
        'd_domen_dis_2',
        'd_domen_dis_r2',
        'd_domen_dis_c2',
        'd_domen_dis_3',
        'd_domen_dis_r3',
        'd_domen_dis_c3',
        'd_domen_dis_4',
        'd_domen_dis_r4',
        'd_domen_dis_c4',
        'd_domen_dis_5',
        'd_domen_dis_r5',
        'd_domen_dis_c5',
        'd_domen_dis_6',
        'd_domen_dis_r6',
        'd_domen_dis_c6',
        'd_domen_dis_7',
        'd_domen_dis_r7',
        'd_domen_dis_c7',
        'd_domen_dis_8',
        'd_domen_dis_r8',
        'd_domen_dis_c8',
        'd_domen_dis_9',
        'd_domen_dis_r9',
        'd_domen_dis_c9',
        'd_domen_dis_10',
        'd_domen_dis_r10',
        'd_domen_dis_c10',
        'd_domen_dis_11',
        'd_domen_dis_r11',
        'd_domen_dis_c11',
        'd_domen_dis_12',
        'd_domen_dis_r12',
        'd_domen_dis_c12',
        'd_domen_dis_13',
        'd_domen_dis_r13',
        'd_domen_dis_c13',
        'd_domen_dis_14',
        'd_domen_dis_r14',
        'd_domen_dis_c14',
        'd_domen_dis_15',
        'd_domen_dis_r15',
        'd_domen_dis_c15',
        'd_domen_dis_16',
        'd_domen_dis_r16',
        'd_domen_dis_c16',
        'd_domen_dis_17',
        'd_domen_dis_r17',
        'd_domen_dis_c17',
        'd_domen_dis_18',
        'd_domen_dis_r18',
        'd_domen_dis_c18',
        'd_domen_dis_19',
        'd_domen_dis_r19',
        'd_domen_dis_c19',
        'd_domen_dis_20',
        'd_domen_dis_r20',
        'd_domen_dis_c20',
        'd_domen_dis_21',
        'd_domen_dis_r21',
        'd_domen_dis_c21',
        'd_domen_dis_22',
        'd_domen_dis_r22',
        'd_domen_dis_c22',
        'd_domen_dis_23',
        'd_domen_dis_r23',
        'd_domen_dis_c23',
        'd_domen_dis_24',
        'd_domen_dis_r24',
        'd_domen_dis_c24',
        'd_domen_dis_25',
        'd_domen_dis_r25',
        'd_domen_dis_c25',
        'e_domen_dis_1',
        'e_domen_dis_1_+/.',
        'e_domen_dis_q1',
        'e_domen_dis_2',
        'e_domen_dis_2_+/.',
        'e_domen_dis_q2',
        'e_domen_dis_3',
        'e_domen_dis_3_+/.',
        'e_domen_dis_q3',
        'e_domen_dis_4',
        'e_domen_dis_4_+/.',
        'e_domen_dis_q4',
        'e_domen_dis_5',
        'e_domen_dis_5_+/.',
        'e_domen_dis_q5',
        'e_domen_dis_6',
        'e_domen_dis_6_+/.',
        'e_domen_dis_q6',
        'e_domen_dis_7',
        'e_domen_dis_7_+/.',
        'e_domen_dis_q7',
        'e_domen_dis_8',
        'e_domen_dis_8_+/.',
        'e_domen_dis_q8',
        'e_domen_dis_9',
        'e_domen_dis_9_+/.',
        'e_domen_dis_q9',
        'e_domen_dis_10',
        'e_domen_dis_10_+/.',
        'e_domen_dis_q10',
        'домены_структуры_вып',
        'домены_функций_вып',
        'домены_активности_и_участия_вып',
        'домены_окружающей_среды_вып',
        'МКФ_сумм_вып',
    ],
    'other': [
        'закл_психолога',
        'MoCA',
        'HADS',
        'HADS_t',
        'HADS_d',
        'закл_логопеда',
        'ш_вассермана',
        'ш_дизартрии',
        'ш_прозопареза',
        'ш_дисфагии',
        'ФИО_ЛФК',
        'ФИО_Физиотерапевт',
        'ФИО_психолог',
        'ФИО_логопед',
        'физио_1',
        'физио_место_1',
        'физио_прдлж_1',
        'физио_2',
        'физио_место_2',
        'физио_прдлж_2',
        'физио_3',
        'физио_место_3',
        'физио_прдлж_3',
        'физио_4',
        'физио_место_4',
        'физио_прдлж_4',
        'лфк_1',
        'лфк_прдлж_1',
        'лфк_2',
        'лфк_прдлж_2',
        'лфк_3',
        'лфк_прдлж_3',
        'лфк_4',
        'лфк_прдлж_4',
        'лфк_5',
        'лфк_прдлж_5',
        'лфк_6',
        'лфк_прдлж_6',
        'лфк_7',
        'лфк_прдлж_7',
        'лфк_8',
        'лфк_прдлж_8',
        'лфк_9',
        'лфк_прдлж_9',
        'лфк_10',
        'лфк_прдлж_10',
        'Шкалы_вып',
        'динамика_вып',
        'MoCA_вып',
        'HADS_вып',
        'HADS_t_вып',
        'HADS_d_вып',
        'ш_вассермана_вып',
        'ш_дизартрии_вып',
        'ш_прозопареза_вып',
        'ш_дисфагии_вып',
    ]
}
